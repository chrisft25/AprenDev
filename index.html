<!DOCTYPE html>
<html>
<head>
	<title>AprenDev</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<script src="js/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.min.js" integrity="sha256-0SGl1PJNDyJwcV5T+weg2zpEMrh7xvlwO4oXgvZCeZk=" crossorigin="anonymous"></script>
</head>
<body>

<h2>Apren.dev</h2>
<div id="container" style="width:800px;height:600px;border:1px solid grey"></div>
<select onchange="lenguajes()" name="lenguajes" id="lenguajes">
	<option value="html" selected>HTML</option>
	<option value="php">PHP</option>
	<option value="javascript">Javascript</option>

</select>
<select onchange="temas()" name="temas" id="temas">
	<option value="vs-dark" selected>Dark</option>
	<option value="vs">Light</option>
	<option value="hc-black">Contraste alto</option>
</select>

<!-- <button onclick="alert(monaco.editor.getModels()[0].getValue().replace(/(\n)/gm,'\\n')); monaco.editor.getModels()[0].setValue(monaco.editor.getModels()[0].getValue().replace(/(\n)/gm,'\\n').replace(/(\\n)/gm,'\n'));">Prueba</button> -->
<button onclick="test()">Retornar valor</button>
<input type="text" name="resultado" id="resultado"/>

<script src="node_modules/monaco-editor/min/vs/loader.js"></script>
<script>
		document.getElementById('resultado').value=null;
		document.getElementById('lenguajes').selectedIndex=null;
		document.getElementById('temas').selectedIndex=null;

	require.config({ paths: { 'vs': 'node_modules/monaco-editor/min/vs' }});

	require(['vs/editor/editor.main'], function() {
		//Inicializamos el editor en lenguaje HTML y con un texto que contiene las etiquetas iniciales
		var editor = monaco.editor.create(document.getElementById('container'), {
			value: '<html>\n\n</html>',
			language: 'html',
			theme: 'vs-dark'
		});
	});

	function temas(){
		var e = document.getElementById("temas"); //Selecciona el select con id "Temas"
		var tema = e.options[e.selectedIndex].value; //Recibe el valor seleccionado
		monaco.editor.setTheme(tema); //Establece el tema, según lo seleccionado
	}

	function lenguajes(){
		var e = document.getElementById("lenguajes"); //Selecciona el select con id "Lenguajes"
		var lenguaje = e.options[e.selectedIndex].value; //Recibe el valor seleccionado
		monaco.editor.setModelLanguage(window.monaco.editor.getModels()[0], lenguaje); //Establece el lenguaje, según lo seleccionado
		switch(lenguaje){
			case "php":
			monaco.editor.getModels()[0].setValue('<?php\nfunction suma($a,$b){\n\n}\n?>'); //Modifica el texto del editor, según el lenguaje
			break;

			case "javascript":
			monaco.editor.getModels()[0].setValue("function suma(a,b){\n\n}");
			break;

			case "html":
			monaco.editor.getModels()[0].setValue('<html>\n\n</html>');
			break;
		}
		
	}

	function test(){
		var code =monaco.editor.getModels()[0].getValue().replace(/(\r\n|\n|\r)/gm,''); //Eliminamos todos los espacios, saltos de linea,etc del valor
		$.ajax({
        type: "POST",
        url: 'test.php', //lo enviamos a test.php para evaluar
        data: {code:code}, //se envía el valor ya formateado
        success: handleData, //al realizarse correctamente, llama a la función handleData
    });

	}

	function handleData(data) {
    document.getElementById('resultado').value=data; //Muestra el resultado de la función escrita en el editor en un input
}

</script>
</body>
</html>


